---
# Talos Machine Configuration patch for {{ .Hostname }}

machine:
{{ if .NTPServers }}
    #
    #   NTP settings
    #
    time:
        disabled: false # Indicates if the time service is disabled for the machine.
        servers:
{{- range .NTPServers }}
        - {{ . }}
{{- end }}
{{- end }}
    network:
        interfaces:
{{- range .Bondings }}
        - interface: {{ .Name }}
          addresses:
{{- range .IPsWithCIDR }}
          - {{ . }}
{{- end }}
          bond:
            mode: 802.3ad
            lacpRate: fast
            interfaces:
{{- range .Interfaces }}
            - {{ .Name -}}
{{ end }}
{{ end }}
{{- range .Interfaces }}
{{ if .IPsWithCIDR }}
        - interface: {{ .Name }}
          addresses:
{{- range .IPsWithCIDR }}
          - {{ . }}
{{- end }}
{{- end }}
{{- end }}
    logging:
{{ range .LoggingEndpoints }}
        destinations:
        - endpoint: {{ . }} # Where to send logs. Supported protocols are "tcp" and "udp".
          format: json_lines # Logs format.
{{- end }}
